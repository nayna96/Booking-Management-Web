{% extends "main_base.html" %}

{% block content %}
{% load static %}
<h3>CUSTOMER MASTER</h3>

<button onclick="show_modal()" class="btn btn-primary">Add</button>

<div id="myModal" class="_modal">
    <div class="_modal-content">        
        <span class="_close">&times;</span>
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">CUSTOMER MASTER</h5>
            
        </div>
        <div class="modal-body">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" data-toggle="tab" href="#customer_info" type="button" role="tab" aria-selected="true">Customer</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-toggle="tab" href="#credentials" type="button" role="tab" aria-selected="true">Credentials</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-toggle="tab" href="#bank" type="button" role="tab" aria-selected="true">Bank</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-toggle="tab" href="#docs" type="button" role="tab" aria-selected="true">Doc Upload</button>
                </li>
            </ul>
        
            <div class="tab-content">
                <div id="customer_info" class="tab-pane fade in active show">
                    <form method="POST" id="form" enctype="multipart/form-data">
                    {% csrf_token %} 
                    <input type="text" name="_id" id="_id" hidden>
                    <div class="row" hidden>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="1">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="2">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="3">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="4">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="5">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="6">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="7">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="8">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="9">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="10">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="11">
                        </div>
                        <div class="col-sm-1 mb-1" style="border: 1px solid;">
                            <input type="text" class="form-control" value="12">
                        </div>
                    </div>
                    <div class="acc_title" onclick="AccFunc('customerDetails')">
                        Customer Details 
                        <i class="fa fa-caret-down"></i>
                    </div>
                    <div id="customerDetails" class="w3-show">
                        <div class="row">
                            <div class="col-sm-2 mb-1">
                                <label>Customer</label>
                                <label class="mandat_symbol">*</label>
                                <select name="customer_salutation" id="customer_salutation" tabindex="1" onchange="setGender(event, 'customer_gender')" class="form-control" required>
                                    <option value="" selected disabled>-- Select --</option>
                                    <option value="MR.">MR.</option>
                                    <option value="MRS.">MRS.</option>
                                    <option value="MS.">MS.</option>
                                </select>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>First Name</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="customer_fname" id="customer_fname" tabindex="2" class="allstring form-control" required>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Middle Name</label>
                                <input type="text" name="customer_mname" id="customer_mname" tabindex="3" class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Last Name</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="customer_lname" id="customer_lname" tabindex="4" class="allstring form-control" required>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>DOB</label>
                                <label class="mandat_symbol">*</label>
                                <input type="date" name="customer_dob" id="customer_dob" tabindex="5" class="form-control" required>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Gender</label>
                                <label class="mandat_symbol">*</label>
                                <select name="customer_gender" id="customer_gender" tabindex="6" class="disable form-control" required>
                                    <option value="" selected disabled>-- Select --</option>
                                    <option value="MALE">MALE</option>
                                    <option value="FEMALE">FEMALE</option>                                    
                                </select>        
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Occupation</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="customer_occupation" id="customer_occupation" class="allstring form-control" tabindex="7" required list="occupationList">
                                <datalist id="occupationList">
                                    <option value="BUSINESS"></option>  
                                    <option value="SELF-EMPLOYED"></option>
                                    <option value="SERVICE"></option>
                                    {% for occupation in occupations_list %}
                                        <option value={{occupation}}>{{occupation}}</option>
                                    {% endfor %}
                                </datalist>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Employer/Company Name</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="customer_employer_company_name" id="customer_employer_company_name" tabindex="8" required class="allstring form-control">
                            </div>
                            <div class="col-sm-4 mb-1">
                                <label>Company Address</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="customer_company_address" id="customer_company_address" tabindex="9" required class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Posted at</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="customer_posted_at" id="customer_posted_at" tabindex="10" required class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Caste</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="customer_caste" id="customer_caste"  class="allstring form-control" tabindex="11" required list="casteList">
                                <datalist id="casteList">
                                    <option value="SC"></option>  
                                    <option value="ST"></option>
                                    {% for caste in castes_list %}
                                        <option value={{caste}}>{{caste}}</option>
                                    {% endfor %}
                                </datalist>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Co-owner</label>
                                <select name="co-owner_salutation" id="co-owner_salutation" tabindex="12" onchange="setGender(event, 'co-owner_gender')" class="form-control">
                                    <option value="" selected>-- Select --</option>
                                    <option value="MR.">MR.</option>
                                    <option value="MRS.">MRS.</option>
                                    <option value="MS.">MS.</option>
                                </select>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>First Name</label>
                                <input type="text" name="co-owner_fname" id="co-owner_fname" tabindex="13" class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Middle Name</label>
                                <input type="text" name="co-owner_mname" id="co-owner_mname" tabindex="14" class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Last Name</label>
                                <input type="text" name="co-owner_lname" id="co-owner_lname" tabindex="15" class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>DOB</label>
                                <input type="date" name="co-owner_dob" id="co-owner_dob" tabindex="16" class="form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Gender</label>
                                <select name="co-owner_gender" id="co-owner_gender" tabindex="17" class="disable form-control">
                                    <option value="" selected>-- Select --</option>
                                    <option value="MALE">MALE</option>
                                    <option value="FEMALE">FEMALE</option>   
                                </select>        
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Occupation</label>
                                <input type="text" name="co-owner_occupation" id="co-owner_occupation" class="allstring form-control" tabindex="18" list="occupationList">
                                <datalist id="occupationList">
                                    <option value="BUSINESS"></option>  
                                    <option value="SELF-EMPLOYED"></option>
                                    <option value="SERVICE"></option>
                                    {% for occupation in occupations_list %}
                                        <option value={{occupation}}>{{occupation}}</option>
                                    {% endfor %}
                                </datalist>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Employer/Company Name</label>
                                <input type="text" name="co-owner_employer_company_name" id="co-owner_employer_company_name" tabindex="19" class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Company Address</label>
                                <input type="text" name="co-owner_company_address" id="co-owner_company_address" tabindex="20" class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Posted at</label>
                                <input type="text" name="co-owner_posted_at" id="co-owner_posted_at" tabindex="21" class="allstring form-control">
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Caste</label>
                                <input type="text" name="co-owner_caste" id="co-owner_caste"  class="allstring form-control" tabindex="22" list="casteList">
                                <datalist id="casteList">
                                    <option value="SC"></option>  
                                    <option value="ST"></option>
                                    {% for caste in castes_list %}
                                        <option value={{caste}}>{{caste}}</option>
                                    {% endfor %}
                                </datalist>
                            </div>
                            <div class="col-sm-2 mb-1">
                                <label>Relation</label>
                                <input type="text" name="co-owner_relation" id="co-owner_relation" tabindex="23" class="allstring form-control">
                            </div>                            
                            <div class="col-sm-4 mb-1">
                                <label>Email</label>
                                <label class="mandat_symbol">*</label>
                                <input type="email" name="email" id="email" tabindex="24" class="allsmall form-control" required>
                            </div>
                            <div class="col-sm-4 mb-1">
                                <label>Mobile No.</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="mobile_no" id="mobile_no" maxlength="10" tabindex="25" onfocusout="copyMobileNo()" class="allnums form-control" required>
                            </div>
                            <div class="col-sm-4 mb-1">
                                <label>Whatsapp No.</label>
                                <input type="text" name="whatsapp_no" id="whatsapp_no" maxlength="10" tabindex="26" class="allnums form-control">
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>Father/Husband</label>
                                <label class="mandat_symbol">*</label>
                                <select name="father_husband's_salutation" id="father_husband's_salutation" tabindex="27" class="form-control" required>
                                    <option value="" selected disabled>-- Select --</option>
                                    <option value="MR.">MR.</option>
                                    <option value="LATE.">LATE.</option>
                                </select>
                            </div>
                            <div class="col-sm-6 mb-1">
                                <label>Name</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="father_husband's_name" id="father_husband's_name" tabindex="28" class="allstring form-control" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>Relation</label>
                                <label class="mandat_symbol">*</label>
                                <select name="relation" id="relation" tabindex="29" class="form-control" required>
                                    <option value="" selected disabled>-- Select --</option>  
                                    <option value="FATHER">FATHER</option>
                                    <option value="HUSBAND">HUSBAND</option>
                                </select>
                            </div>
                            <div class="col-sm-3 mb-1">                                
                                <label>Contact Person</label>
                                <select name="copy_from" id="copy_from" onchange="copyFrom(event)" class="form-control" tabindex="30" >
                                    <option value="" selected>-- Select --</option>
                                    <option value="CUSTOMER">CUSTOMER</option>
                                    <option value="CO-OWNER">CO-OWNER</option>
                                </select>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>Title</label>
                                <label class="mandat_symbol">*</label>
                                <select name="contact_p_salutation" id="contact_p_salutation" class="form-control" tabindex="31" required>
                                    <option value="" selected disabled>-- Select --</option>
                                    <option value="MR.">MR.</option>
                                    <option value="MRS.">MRS.</option>
                                    <option value="MS.">MS.</option>
                                </select>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>Name</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="contact_p_name" id="contact_p_name" class="allstring form-control" tabindex="32" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>Mobile no</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="contact_p_phone_no" id="contact_p_phone_no" maxlength="10" class="allnums form-control" tabindex="33" required>
                            </div>
                        </div>
                    </div>
                    <div class="acc_title" onclick="AccFunc('address')">
                        Address details
                        <i class="fa fa-caret-down"></i>
                    </div>
                    <div id="address" class="w3-show">
                        <div class="row">
                            <div class="col-sm-6 mb-1">
                                <label style="font-weight: bold;">Present Address</label>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label style="font-weight: bold;">Permanent Address</label>
                            </div>
                            <div class="col-sm-3 mb-1" style="text-align: right;">
                                <input type="checkbox" id="copy_present" name="copy_present" tabindex="34" value="Copy Present Address" onclick="copyPresentAddress()">                                
                                <label for="copy_present">Copy Present Address</label>                                
                            </div>
                            <div class="col-sm-6 mb-1">
                                <label>Address Line 1</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pr_addLine1" id="pr_addLine1" class="allcaps form-control" tabindex="35" required>
                            </div>
                            <div class="col-sm-6 mb-1">
                                <label>Address Line 1</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pe_addLine1" id="pe_addLine1" class="allcaps form-control" tabindex="41" required>
                            </div>
                            <div class="col-sm-6 mb-1">
                                <label>Address Line 2</label>
                                <input type="text" name="pr_addLine2" id="pr_addLine2" class="allcaps form-control" tabindex="36">
                            </div>
                            <div class="col-sm-6 mb-1">
                                <label>Address Line 2</label>
                                <input type="text" name="pe_addLine2" id="pe_addLine2" class="allcaps form-control" tabindex="42">
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>District</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pr_district" id="pr_district" class="allstring form-control" tabindex="37" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>City</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pr_city" id="pr_city" class="allstring form-control" tabindex="38" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>District</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pe_district" id="pe_district" class="allstring form-control" tabindex="43" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>City</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pe_city" id="pe_city" class="allstring form-control" tabindex="44" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>State</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pr_state" id="pr_state" class="allstring form-control" tabindex="39" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>Pin code</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pr_pincode" id="pr_pincode" maxlength="6" class="allnums form-control" tabindex="40" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>State</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pe_state" id="pe_state" class="allstring form-control" tabindex="45" required>
                            </div>
                            <div class="col-sm-3 mb-1">
                                <label>Pin code</label>
                                <label class="mandat_symbol">*</label>
                                <input type="text" name="pe_pincode" id="pe_pincode" maxlength="6" class="allnums form-control" tabindex="46" required>
                            </div>
                        </div>   
                    </div>                          
                </div>
                <div id="credentials" class="tab-pane fade">
                    <div class="row">
                        <div class="col-sm-6 mb-1">
                            <label>User Name</label>
                            <input type="text" name="username" id="username" tabindex="1" class="form-control">

                            <label>Password</label>
                            <input type="password" name="password" id="password" tabindex="2" class="form-control">

                            <label>Passport photo</label>
                            <input type="file" name="passport_photo" id="passport_photo" tabindex="3" onchange="showImage(this);"/> 
                        </div>
                        <div class="col-sm-6 mb-1"> 
                            <div>                                
                                <img id="pic" src="#" style="width: 193px; height: 193px;" alt="passport_photo"/>  
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 mb-1">
                        </div>
                    </div> 
                    <div class="row">
                        <div class="col-sm-6 mb-1">
                        </div>
                    </div>                         
                </div>
                <div id="bank" class="tab-pane fade">
                    <div class="row">
                        <div class="col-sm-3 mb-1">
                            <label>Bank Name</label>
                            <label class="mandat_symbol">*</label>
                            <input type="text" name="bank_name" id="bank_name" tabindex="1" class="allstring form-control" required>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>Branch Name</label>
                            <label class="mandat_symbol">*</label>
                            <input type="text" name="branch_name" id="branch_name" tabindex="2" class="allstring form-control" required>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>Address</label>
                            <label class="mandat_symbol">*</label>
                            <input type="text" name="branch_address" id="branch_address" tabindex="3" class="allcaps form-control" required>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>City</label>
                            <label class="mandat_symbol">*</label>
                            <input type="text" name="branch_city" id="branch_city" tabindex="4" class="allstring form-control" required>
                        </div>
                        <div class="col-sm-4 mb-1">
                            <label>IFSC Code</label>
                            <label class="mandat_symbol">*</label>
                            <input type="text" name="ifsc_code" id="ifsc_code" tabindex="5" class="allcaps form-control" required>
                        </div>
                        <div class="col-sm-4 mb-1">
                            <label>Account Type</label>
                            <label class="mandat_symbol">*</label>
                            <select required name="account_type" id="account_type" tabindex="6" class="form-control">
                                <option value="" selected disabled>-- Select --</option>
                                <option value="SAVINGS">SAVINGS</option>
                                <option value="CURRENT">CURRENT</option>
                                <option value="CASH CREDIT">CASH CREDIT</option>
                            </select>
                        </div>
                        <div class="col-sm-4 mb-1">
                            <label>Account No</label>
                            <label class="mandat_symbol">*</label>
                            <input type="text" name="account_no" id="account_no" tabindex="7" class="allcaps form-control" required>
                        </div>
                    </div>
                </div>
                <div id="docs" class="tab-pane fade">
                    <div class="row">
                        <div class="col-sm-3 mb-1">
                            <label>Doc Type</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>Doc No.</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>Upload</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>Files</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>AADHAR CARD</label>
                            <label class="mandat_symbol">*</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="text" name="aadhar_no" id="aadhar_no" maxlength="12" tabindex="1" class="allnums form-control" required>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="file" name="aadhar_card" id="aadhar_card" tabindex="2" class="file" onchange="updateTable('aadhar_card', 'aadharCard', false)" onclick="this.value = null;"/>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <table id="aadharCard" class="table filesList">
                            </table>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>PAN CARD</label>
                            <label class="mandat_symbol">*</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="text" name="pan_no" id="pan_no" maxlength="10" tabindex="3" class="allcaps form-control" required>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="file" name="pan_card" id="pan_card" tabindex="4" class="file" onchange="updateTable('pan_card', 'panCard', false)" onclick="this.value = null;"/>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <table id="panCard" class="table filesList">
                            </table>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>VOTER ID CARD</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="text" name="voter_id" id="voter_id" maxlength="10" tabindex="5" class="allcaps form-control">
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="file" name="voter_id_card" id="voter_id_card" tabindex="6" class="file" onchange="updateTable('voter_id_card', 'voterIDCard', false)" onclick="this.value = null;"/>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <table id="voterIDCard" class="table filesList">
                            </table>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>GST</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="text" name="gst_no" id="gst_no" maxlength="15" tabindex="7" class="allcaps form-control">
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="file" name="gst_doc" id="gst_doc" tabindex="8" class="file" onchange="updateTable('gst_doc', 'gstDoc', false)" onclick="this.value = null;"/>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <table id="gstDoc" class="table filesList">
                            </table>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>Cancelled cheque/Passbook</label>
                        </div>
                        <div class="col-sm-3 mb-1">
                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="file" multiple name="cancelled_cheque_passbook" id="cancelled_cheque_passbook" tabindex="9" class="file" onchange="updateTable('cancelled_cheque_passbook', 'cancelled_chequePassbook', false)" onclick="this.value = null;"/>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <table id="cancelled_chequePassbook" class="table filesList">
                            </table>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <label>OTHER DOCS</label>
                        </div>
                        <div class="col-sm-3 mb-1">

                        </div>
                        <div class="col-sm-3 mb-1">
                            <input type="file" multiple name="other_docs" id="other_docs" tabindex="10" class="file" onchange="updateTable('other_docs', 'otherDocs', true)" onclick="this.value = null;"/>
                        </div>
                        <div class="col-sm-3 mb-1">
                            <table id="otherDocs" class="table filesList">
                            </table>
                        </div>                        
                    </div>
                    <input type="submit" onclick="return formValidation()" id="btn" tabindex="11" class="btn btn-primary" name="Save" value="Save"/>
                    </form>
                </div>
            </div>   
        </div>    
        <div class="modal-footer">

        </div>
    </div>
</div>

<table id="fancyTable" class="table fancyTable">
    <thead>
        <tr>
            <th>CUSTOMER</th>
            <th>City</th>
            <th>Mobile No.</th>
            <th>Whatsapp</th>
            <th>Email ID</th>
            <th colspan="3">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for customer in customerDetails %}
        <tr>
            <td>
                <a href="#" onclick="showCustomerData('/customer_master/{{customer.customer_fname}} {{ customer.customer_mname }} {{ customer.customer_lname }}')">
                    {{ customer.customer_salutation }} {{ customer.customer_fname }} {{ customer.customer_lname }}
                </a>
            </td>
            <td>{{ customer.pr_city }}</td>
            <td>{{ customer.mobile_no }}</td>
            <td>{{ customer.whatsapp_no }}</td>
            <td>{{ customer.email }}</td>
            <td><a class="btn btn-primary" onclick="showCustomerData('/customer_master/{{customer.customer_fname}} {{ customer.customer_mname }} {{ customer.customer_lname }}')">View</a></td>
            <td><a class="btn btn-primary" onclick="showCustomerData('/customer_master/{{customer.customer_fname}} {{ customer.customer_mname }} {{ customer.customer_lname }}')"><i class="fa fa-fw fa-edit"></a></td>
            <td><button class="btn btn-danger"><i class="fa fa-fw fa-trash"></i></button></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script type="text/javascript">
date = getMaxDate();
document.getElementById("customer_dob").setAttribute("max", date);
document.getElementById("co-owner_dob").setAttribute("max", date);

window.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll("input[type=date]").forEach(el => {
        el.addEventListener('focusout',function (e) {
            maxdateValidation(e);
        });
    });
});
    
function setGender(e, id){
  var salutation = e.target.value;
  if(salutation == "MR."){
    document.getElementById(id).value = "MALE";
  } else if(salutation == "MRS." || salutation == "MS."){
    document.getElementById(id).value = "FEMALE";
  }
}

function copyMobileNo(){
    mobile_no = $("#mobile_no").val();

    _url = "/if_phno_exist/" + mobile_no;
    $.ajax({      
        url: _url,
        async: false,
        success: function(response){
            ph_exists = response["ph_exists"];
        },
        error: function(error){
            console.log(error)
        }
    });

    if(ph_exists){
        alert("Two customers cannot have same phone no!");
    }

    $("#whatsapp_no").val(mobile_no);
}

function copyPresentAddress(){
  var checkBox = document.getElementById("copy_present");
  if (checkBox.checked == true){
    $("#pe_addLine1").val($("#pr_addLine1").val());
    $("#pe_addLine2").val($("#pr_addLine2").val());
    $("#pe_state").val($("#pr_state").val());
    $("#pe_district").val($("#pr_district").val());
    $("#pe_city").val($("#pr_city").val());
    $("#pe_pincode").val($("#pr_pincode").val());
  } else {
    $("#pe_addLine1").val("");
    $("#pe_addLine2").val("");
    $("#pe_state").val("");
    $("#pe_district").val("");
    $("#pe_city").val("");
    $("#pe_pincode").val("");
  }
}

function copyFrom(e){
  var val = e.target.value;
  $("#contact_p_phone_no").val($("#mobile_no").val());
  if(val == "CUSTOMER"){
    $("#contact_p_salutation").val($("#customer_salutation").val());
    $("#contact_p_name").val($("#customer_fname").val() + " " + $("#customer_mname").val() + " " + $("#customer_lname").val()); 
  } else if(val == "CO-OWNER"){
    $("#contact_p_salutation").val($("#co-owner_salutation").val());
    $("#contact_p_name").val($("#co-owner_fname").val() + " " + $("#co-owner_mname").val() + " " + $("#co-owner_lname").val());
  } else if(val == ""){
    $("#contact_p_salutation").val("");
    $("#contact_p_name").val("");
    $("#contact_p_phone_no").val("");
  }
}

function validateEmail(email) {
    const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
}

function formValidation(){
    if(!requiredValidation()){
        return false
    }

    if($("#mobile_no").val().length < 10){
        alert("Please enter  a valid customer phone no.!");
        return false;
    }

    if($("#whatsapp_no").val().length > 0 && $("#whatsapp_no").val().length < 10){
        alert("Please enter  a valid customer whatsapp no.!");
        return false;
    }

    if($("#pr_pincode").val().length < 6){
        alert("Please enter  a valid present address pincode!");
        return false;
    }

    if($("#pe_pincode").val().length < 6){
        alert("Please enter  a valid permanent address pincode!");
        return false;
    }

    if($("#contact_p_phone_no").val().length < 10){
        alert("Please enter  a valid contact person phone no.!");
        return false;
    }

    if($("#aadhar_no").val().length < 12){
        alert("Please enter  a valid aadhar no.!");
        return false; 
    }

    email = $("#email").val();
    if (!validateEmail(email))
    {
        alert("Please enter  a valid email!");
        return false;
    }
            
    var pan_no = $("#pan_no").val();
    var regex = /[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
    if(!regex.test(pan_no)){      
        alert("Please enter a valid pan no!");    
        return false;   
    }

    var voter_id_no = $("#voter_id").val();
    if(voter_id_no.length > 0){
        var regex = /^([a-zA-Z]){3}([0-9]){7}?$/g;
        if(!regex.test(voter_id_no)){      
            alert("Please enter a valid voter_id no!");    
            return false;   
        }
    }
    
    var gst_no = $("#gst_no").val();
    if (gst_no.length > 0) {
        var regex = new RegExp('^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]1}[1-9A-Z]{1}Z[0-9A-Z]{1}$');    
        if (!regex.test(gst_no)) {
            alert("Please enter a valid gst no!");       
            return true;    
        } 
    }

    // IF EXISTS
    exists = false;
    if($("#btn").val() == "Save"){
        dt = [
            { "customer_fname": $("#customer_fname").val() },
            { "customer_mname": $("#customer_mname").val() },
            { "customer_lname": $("#customer_lname").val() },
        ]

        ifExists("Master", "Customer", dt).done(function(response){
            exists = response["result"];            
        });

        if(exists){
            alert("Data for this cutomer already exists!")
            return false;
        }
    }

    alert("Data saved sucessfully!");
    return true;
}

</script>

{% endblock content %}